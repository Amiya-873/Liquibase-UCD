<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{color:#0563C1;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:#954F72;
	text-decoration:underline;}
.MsoChpDefault
	{font-size:10.0pt;
	font-family:"Calibri","sans-serif";}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
-->
</style>

</head>

<body lang=EN-US link="#0563C1" vlink="#954F72">

<div class=WordSection1>

<p class=MsoNormal>During my numerous UrbanCode Deploy demos, PoTs, PoCs I was
always afraid of one question: How do you handle database deployments? You had
two options: run database scripts or use DBUpgrader (which is nice but not very
well documented). Now there is a new option. You can use Liquibase. </p>

<p class=MsoNormal>Liquibase is open source command line tool that run database
deployment and rollbacks. It supports all major database types: DB2, Oracle,
MSSQL, MySQL, PostgreSQL, Sybase, Informix, etc. Liquibase uses database change
log files to run all db commands (same strategy that DBUpgrader is using).
Change logs can be described in many different formats. I usually prefer XMLs
or SQLs.  You can read about all Liquibase functionality here <a
href="http://www.liquibase.org/">http://www.liquibase.org/</a> </p>

<p class=MsoNormal>Our Prague DevOps lab (me and Ondrej Hubacek) has developed
UrbanCode Deploy plugin that can be used to execute all Liquibase commands as
part of your deployment process. In example below I use sql log file to insert two
new rows in MySQL database table department. Please notice I also declare my
rollback strategy.</p>

<p class=MsoNormal><img border=0 width=372 height=97
src="image001.jpg"></p>

<p class=MsoNormal>In deploy process I can download latest version of the
database log file and I just call Update step to run Liquibase update command
with this log file. I also validate if everything was ok and generate database
html documentation.</p>

<p class=MsoNormal><img border=0 width=383 height=328
src="image002.jpg"></p>

<p class=MsoNormal>You can read more details about all commands here <a
href="http://www.liquibase.org/documentation/command_line.html">http://www.liquibase.org/documentation/command_line.html</a></p>

<p class=MsoNormal>You also need to define standard Liquibase properties such
as liquibase command, jdbc driver, classpath, jdbc url in your Resource
properties:</p>

<p class=MsoNormal><img border=0 width=401 height=271
src="image003.jpg"></p>

<p class=MsoNormal>In your deployment process step you can reuse these properties
and add username and password for database access. Most important is to state
your change log file (xml, sql or any other supported format). For rollback
step below you can define your rollback strategy (rollback number of change
sets, rollback to date, rollback to tag). Then for rollback value you need to
enter value related to your rollback type.</p>

<p class=MsoNormal><img border=0 width=407 height=372
src="image004.jpg"></p>

<p class=MsoNormal>Then you can happily execute your deployment process to run
specified database updates:</p>

<p class=MsoNormal><img border=0 width=491 height=177
src="image005.jpg"></p>

<p class=MsoNormal>You can also view this generated html report that summarizes
all database changes:</p>

<p class=MsoNormal><img border=0 width=412 height=226 id="Picture 1"
src="image006.jpg"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>That’s it. It’s pretty simple but powerful. Liquibase has
lot of useful database commands you can use to handle your database deployments
better. There is also lot of documentation about database update strategies.
Hope you find it useful. Please let me know if there any plugin improvements
you would like to see.</p>

</div>

</body>

</html>
